<!-- Extend the base template to inherit common layout and navigation -->
{% extends 'pos_app/base.html' %}

<!-- Set the page title with sale ID for the browser tab -->
{% block title %}Sale #{{ sale.id }} - POS System{% endblock %}

<!-- Main content block that will be inserted into the base template -->
{% block content %}
<!-- Use Bootstrap grid system for layout -->
<div class="row">
    <!-- Full width column for sale details -->
    <div class="col-md-12">
        <!-- Main heading with sale ID -->
        <h2>Sale #{{ sale.id }}</h2>

        <!-- Display sale metadata -->
        <p><strong>Date:</strong> {{ sale.created_at }}</p>
        <p><strong>User:</strong> {{ sale.user.username }}</p>
        <!-- Use Django's get_FOO_display method to show human-readable payment method -->
        <p><strong>Payment Method:</strong> {{ sale.get_payment_method_display }}</p>
        <p><strong>Total Amount:</strong> ₱{{ sale.total_amount }}</p>

        <!-- Section heading for sale items -->
        <h3>Items</h3>
        <!-- Bootstrap table with striped rows for better readability -->
        <table class="table table-striped">
            <!-- Table header with column names -->
            <thead>
                <tr>
                    <th>Product</th>
                    <th>Quantity</th>
                    <th>Unit Price</th>
                    <th>Total Price</th>
                </tr>
            </thead>
            <!-- Table body with sale items data -->
            <tbody>
                <!-- Loop through all items related to this sale using the 'items' related manager -->
                {% for item in sale.items.all %}
                    <tr>
                        <!-- Display product name from the related Product model -->
                        <td>{{ item.product.name }}</td>
                        <!-- Display quantity purchased -->
                        <td>{{ item.quantity }}</td>
                        <!-- Display unit price at time of sale -->
                        <td>₱{{ item.unit_price }}</td>
                        <!-- Display total price for this line item -->
                        <td>₱{{ item.total_price }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>

        <!-- Navigation link back to sales reports page -->
        <a href="{% url 'pos_app:sales_report' %}" class="btn btn-secondary">Back to Reports</a>
    </div>
</div>
{% endblock %}
